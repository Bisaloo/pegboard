---
title: "Introduction to the Episode Object"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to the Episode Object}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction

The {pegboard} package facilitates the analysis and manipulation of Markdown and
R Markdown files by translating them to XML and back again. This extends the
{tinkr} package by providing additional methods that are specific for 
Carpentries-style lessons. There are two `R6` classes defined in {pegboard}:

 - `Episode` objects that contain the XML data, YAML metadata and extra fields
   that define the child and parent files for a particular episode
 - `Lesson` objects that contain lists of `Episode` objects categorised as 
   "episodes", "extra", or "children"

This vignette will be discussing the structure of Episode objects, how to 
query the contents with the {xml2} package, and how to use the methods and 
active bindings to get information about, extract, and manipulate anything
inside of a Markdown or R Markdown document.


## Reading Markdown Content

Each `Episode` object starts from a Markdown file. It can be any markdown file,
but for us to explore what the `Episode` object has to offer us, let's take an
example R Markdown file that is present in a fragment of a Carpentries Workbench
lesson that we have in this package. We will be using the {xml2} package to 
explore the object and the {fs} package to help with constructing file paths.

```{r setup}
library("pegboard")
library("xml2")
library("fs")
```


```{r intro-read}
lsn <- lesson_fragment("sandpaper-fragment")
dir_tree(lsn, recurse = 1, regex = "site/[^R].*", invert = TRUE)

# Read in the intro.Rmd document as an `Episode` object
intro_path <- path(lsn, "episodes", "intro.Rmd")
intro <- Episode$new(intro_path)
```

If I print out the Episode object, I'm going to get a long list of methods,
fields and active bindings (functions that act like fields) printed:

```{r intro-print}
intro
```

The actual XML content is in the `$body` field. This contains all the data from
the markdown document, but in XML form. 

```{r intro-body}
intro$body
```

If you want to see what the contents look like, you can use the `$show()`,
`$head()`, or `$tail()` methods (note: the `$show()` method will print out the
entire markdown document).

```{r intro-show}
intro$head(10)
intro$tail(10)
```

## Analysis

You can use {pegboard} to account for elements within the document. Many of
these are embedded as 

